generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DATABASE_URL_UNPOOLED")
}

model Trip {
  id            String   @id @default(cuid())
  slug          String   @unique
  title         String
  subtitle      String
  dedication    String
  tripDates     String
  baseLocation  String
  heroImage     String
  giver         String
  receiver      String
  soundtrackUrl String?
  spots         Spot[]
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model Spot {
  id                 String   @id @default(cuid())
  tripId             String
  trip               Trip     @relation(fields: [tripId], references: [id], onDelete: Cascade)
  orderIndex         Int
  name               String
  dayLabel           String
  dateLabel          String
  time               String
  location           String
  address            String
  note               String
  lat                Float
  lng                Float
  mapX               Float
  mapY               Float
  unlockRadiusMeters Int
  arrivalPoints      Int      @default(0)
  headline           String
  memoryBody         String
  prompt             String?
  message            String
  photos             Photo[]
  missions           Mission[]
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt
}

model Photo {
  id        String   @id @default(cuid())
  spotId    String
  spot      Spot     @relation(fields: [spotId], references: [id], onDelete: Cascade)
  orderIndex Int
  imageUrl  String
  alt       String
  caption   String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Mission {
  id           String       @id @default(cuid())
  spotId       String
  spot         Spot         @relation(fields: [spotId], references: [id], onDelete: Cascade)
  title        String
  type         MissionType
  description  String
  rewardPoints Int          @default(50)
  photoPrompt  String?
  checklistLabel String?
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
}

enum MissionType {
  PHOTO
  CHECKIN
  QUEST
}
